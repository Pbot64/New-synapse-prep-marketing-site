// Node Modules
import express from "express";
import bodyParser from "body-parser";

const app = express();

// Load Input Validation
import validateZipInput from "../validation/zip";

app.use(bodyParser.urlencoded({ extended: false }));
app.use(bodyParser.json());

app.post("*", (req, res) => {
  const { errors, isValid } = validateZipInput(req.body);
  if (!isValid) {
    return res.status(400).json(errors);
  }
  const austinZipsNumber = [
    78704,
    78701,
    78745,
    78741,
    78703,
    78702,
    78712,
    78705,
    78746,
    78722,
    78744,
    78721,
    78751,
    78756,
    78735,
    78749,
    78748,
    78723,
    78742,
    78731,
    78752,
    78757,
    78747,
    78739,
    78733,
    78719,
    78652,
    78730,
    78725,
    78724,
    78736,
    78758,
    78759,
    78753,
    78754,
    78750,
    78732,
    78737,
    78617,
    78610,
    78727,
    78726,
    78738,
    78734,
    78729,
    78651,
    78728,
    78653,
    78691,
    78660,
    78717,
    78640,
    78630,
    78613,
    78645,
    78683,
    78680,
    78681,
    78619,
    78664,
    78682,
    78612,
    78665,
    78641,
    78620,
    78646,
    78656,
    78669,
    78644,
    78634,
    78676,
    78621,
    78667,
    78627,
    78602,
    78662,
    78628,
    78616,
    78615,
    78666,
    78655,
    78626,
    78674,
    76574,
    78670,
    78622,
    78642,
    78650,
    78654,
    78623,
    78633,
    78661,
    78673,
    78953,
    78636,
    78133,
    76578,
    78605,
    78663,
    76530,
    78957,
    78648,
    78659,
    78606,
    76537,
    76527,
    78638,
    78132,
    78657,
    78130,
    78115,
    76573,
    78632,
    78135,
    78131,
    76577,
    76511,
    78947,
    78070,
    78635,
    78658,
    78027,
    78123,
    78155,
    78963,
    78156,
    76571,
    78941,
    78611,
    78959,
    78948,
    78608,
    78639,
    78604
  ];

  const austinZips = austinZipsNumber.map(String);
  if (austinZips.includes(req.body.zip)) {
    res.send("local");
  } else {
    res.send("distant");
  }
});

export default app;
